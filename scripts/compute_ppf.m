
p1=[-0.16652199625968933, 0.25005519390106201, -0.24665860831737518];
p2=[-0.16820800304412842, 0.25001901388168335, -0.22393599152565002];
n1=[-0.82369929552078247, -0.39336895942687988, -0.40838754177093506];
n2=[-0.71220809221267700, -0.56402838230133057, 0.41788944602012634];

d=p2-p1;
%d=d./norm(d);

%from linalg::angle(u,v)
f1 = acos(dot(n1,d)/( norm(n1)*norm(d)));

% from Bertram
%f1 = atan2(dot(n1,d),norm(cross(n1,d)));
f1 = atan2(norm(cross(n1,d)), dot(n1,d));
f2 = atan2(norm(cross(n2,d)), dot(n2,d));
f3 = atan2(norm(cross(n1,n2)), dot(n1,n2));
f4 = norm(d);

